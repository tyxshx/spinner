<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Spin Wheel</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0f1220;
  color: white;
  text-align: center;
}

#wheelWrapper {
  width: 320px;
  height: 320px;
  margin: 30px auto;
  position: relative;
}

#pointer {
  position: absolute;
  top: -12px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 12px solid transparent;
  border-right: 12px solid transparent;
  border-bottom: 20px solid white;
  z-index: 10;
}

#wheelSVG {
  width: 100%;
  height: 100%;
  transition: transform 3.8s cubic-bezier(0.25, 0.8, 0.25, 1);
}

button {
  padding: 12px 18px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}

#spinBtn {
  background: #ff4d4d;
  color: white;
}

#adminLogin {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  display: none;
  align-items: center;
  justify-content: center;
}

#adminBox {
  background: #1a1d35;
  padding: 25px;
  border-radius: 10px;
  width: 260px;
}

input {
  width: 100%;
  padding: 10px;
  margin-top: 10px;
  border-radius: 6px;
  border: none;
}
</style>
</head>

<body>

<h1>Spin & Win ðŸŽ‰</h1>

<div id="wheelWrapper">
  <div id="pointer"></div>
  <svg id="wheelSVG" viewBox="0 0 500 500"></svg>
</div>

<input id="nameInput" placeholder="Your name" />
<br><br>
<button id="spinBtn">SPIN</button>

<div id="result"></div>

<!-- Admin Login -->
<div id="adminLogin">
  <div id="adminBox">
    <h3>Admin Login</h3>
    <input id="adminUser" placeholder="Username" />
    <input id="adminPass" type="password" placeholder="Password" />
    <br><br>
    <button onclick="loginAdmin()">Login</button>
  </div>
</div>

<script>
/* =========================
   ADMIN AUTH
========================= */
const ADMIN_USERNAME = "admin";
const ADMIN_PASSWORD_HASH =
"8b9d2f3b7e4f0c6d35b88c1c5d4b5fdbbfc6b84e2c9f6c6c1caa8b0c6a0b6f1c";

async function sha256(str) {
  const buf = await crypto.subtle.digest(
    "SHA-256",
    new TextEncoder().encode(str)
  );
  return Array.from(new Uint8Array(buf))
    .map(b => b.toString(16).padStart(2, "0"))
    .join("");
}

async function loginAdmin() {
  const u = adminUser.value.trim();
  const p = adminPass.value;

  if (u !== ADMIN_USERNAME) return alert("Wrong username");

  const h = await sha256(p);
  if (h !== ADMIN_PASSWORD_HASH) return alert("Wrong password");

  alert("Admin logged in");
  adminLogin.style.display = "none";
}

/* =========================
   WHEEL DATA
========================= */
let prizes = [];
let rotation = 0;

/* Fallback prizes if admin list empty */
function getActivePrizes() {
  if (!prizes || prizes.length === 0) {
    return ["Prize 1","Prize 2","Prize 3","Prize 4","Prize 5","Prize 6"];
  }
  return prizes;
}

/* =========================
   SVG WHEEL
========================= */
function drawWheel() {
  const svg = document.getElementById("wheelSVG");
  svg.innerHTML = "";

  const list = getActivePrizes();
  const count = list.length;
  const cx = 250, cy = 250, r = 240;
  const slice = (2 * Math.PI) / count;

  list.forEach((label, i) => {
    const start = i * slice;
    const end = start + slice;

    const x1 = cx + r * Math.cos(start);
    const y1 = cy + r * Math.sin(start);
    const x2 = cx + r * Math.cos(end);
    const y2 = cy + r * Math.sin(end);

    const path = document.createElementNS("http://www.w3.org/2000/svg","path");
    path.setAttribute(
      "d",
      `M ${cx} ${cy} L ${x1} ${y1} A ${r} ${r} 0 0 1 ${x2} ${y2} Z`
    );

    path.setAttribute(
      "fill",
      `hsl(${(i / count) * 360}, 75%, 55%)`
    );

    svg.appendChild(path);

    const angle = start + slice / 2;
    const tx = cx + (r - 45) * Math.cos(angle);
    const ty = cy + (r - 45) * Math.sin(angle);

    const text = document.createElementNS("http://www.w3.org/2000/svg","text");
    text.setAttribute("x", tx);
    text.setAttribute("y", ty);
    text.setAttribute("fill", "white");
    text.setAttribute("font-size", "16");
    text.setAttribute("text-anchor", "middle");
    text.setAttribute("dominant-baseline", "middle");
    text.setAttribute(
      "transform",
      `rotate(${(angle * 180 / Math.PI)}, ${tx}, ${ty})`
    );
    text.textContent = label;

    svg.appendChild(text);
  });
}

drawWheel();

/* =========================
   SPIN
========================= */
spinBtn.onclick = () => {
  const name = nameInput.value.trim();
  if (!name) return alert("Enter name");

  const list = getActivePrizes();
  const spins = Math.random() * 360 + 1800;
  rotation += spins;

  wheelSVG.style.transform = `rotate(${rotation}deg)`;

  const slice = 360 / list.length;
  const index = Math.floor(
    ((360 - (rotation % 360)) % 360) / slice
  );

  setTimeout(() => {
    result.innerHTML =
      `<b>${name}</b> won <b>${list[index]}</b> ðŸŽ‰`;
  }, 3800);
};

/* Hidden admin trigger */
document.addEventListener("keydown", e => {
  if (e.shiftKey && e.key === "A") {
    adminLogin.style.display = "flex";
  }
});
</script>

</body>
</html>
